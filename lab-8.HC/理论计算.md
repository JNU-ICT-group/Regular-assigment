# 无失真信源编码的理论极限计算

## 1. 问题描述
本实验需要通过理论推导，计算三种消息文件的无失真信源编码的理论极限，包括：
- 压缩文件的最小尺寸
- 最高压缩比

同时对比理论计算结果与实际实验中使用工具 **7z压缩工具** 的压缩效果，分析差距产生的原因。

---

## 2. 理论基础
无失真信源编码的核心依据是 **信源编码定理**，该定理指出：
> 一个具有熵 \( H(X) \) 的离散无记忆信源，在无失真的情况下，可以将每个符号压缩到平均长度为\(H(X) \)比特，而不丢失信息。其压缩后的码字长度的期望值不能低于熵 \( H(X) \)。
- **下限**：码字的平均长度 \( L \) 满足
  \[
  L \geq H(X)
  \]
- **上限**：存在一种编码方式，使得平均码长接近 \( H(X) \)，即
  \[
  L \to H(X) \quad \text{当 } N \to \infty
  \]
  其中 \( N \) 是消息的长度。
### 2.1 数学解释
信源 \( X \) 的熵 \( H(X) \) 定义为：
\[
H(X) = -\sum_{i=1}^n P(x_i) \log_2 P(x_i)
\]
其中：
- \( P(x_i) \) 是信源符号 \( x_i \) 出现的概率；
- \( n \) 是符号集合的大小（例如，对于二元信源，\( n=2 \)）。

熵 \( H(X) \) 是信源的理论压缩极限，它表示信源每个符号携带的平均信息量。

对于实际编码长度 \( L \)，理想的压缩方案满足：
\[
L \approx H(X)
\]

---
### 2.2 信息熵
信源 \( X \) 的熵 \( H(X) \) 定义为：
\[
H(X) = -\sum_{i=1}^n P(x_i) \log_2 P(x_i)
\]
其中：
- \( P(x_i) \) 是信源符号 \( x_i \) 出现的概率；
- \( n \) 是符号集合的大小（例如，对于二元信源，\( n=2 \)）。

信息熵衡量了信源的不确定性，值越大表示信息越难以压缩。

### 2.3 最小文件尺寸
根据信源编码定理，无失真信源编码的理论极限（即压缩后的最小文件尺寸）为：
\[
\text{最小文件尺寸} = H(X) \cdot N
\]
其中 \( N \) 为文件的符号总数。

### 2.4 最高压缩比
最高压缩比定义为原始文件大小与压缩后文件大小的比值：
\[
\text{压缩比} = \frac{\text{原始文件大小}}{\text{压缩后文件大小}} = \frac{N \cdot 1}{H(X) \cdot N} = \frac{1}{H(X)}
\]
对于二元信源，原始文件每个符号占用 8 bit，因此原始文件大小为 \( 8*N \) bit。

---

## 3. 理论计算过程
设消息文件的长度为 \( N = 102400 \)（即 100 KB 文件，每个符号为 8 bit，即 1 byte）。三种概率分布的理论极限计算如下：

### 3.1 等概率分布
- **概率分布**：\( P(x_0) = P(x_1) = 0.5 \)
- **熵**：
  \[
  H(X) = -0.5 \log_2 0.5 - 0.5 \log_2 0.5 = 1 \, \text{bit/symbol}
  \]
- **最小文件尺寸**：
  \[
  \text{最小文件尺寸} = H(X) \cdot N = 1 \cdot 102400 = 102,400 \, \text{byte}
  \]
- **压缩比**：
  \[
  \text{压缩比} = \frac{1}{H(X)} = \frac{1}{1} = 1
  \]

---

### 3.2 偏概率分布 1 (\( P(x_0) = 0.3, P(x_1) = 0.7 \))
- **熵**：
  \[
  H(X) = -0.7 \log_2 0.7 - 0.3 \log_2 0.3
  \]

  \[
  H(X) \approx 0.88129 \, \text{bit/symbol}
  \]
- **最小文件尺寸**：
  \[
  \text{最小文件尺寸} = H(X) \cdot N \approx 0.88129 \cdot 102400 = 90,244 \, \text{byte}
  \]
- **压缩比**：
  \[
  \text{压缩比} = \frac{1}{H(X)} = \frac{1}{0.88129} \approx 1.1347
  \]

---

### 3.3 偏概率分布 2 (\( P(x_0) = 0.8, P(x_1) = 0.2 \))
- **熵**：
  \[
  H(X) = -0.8 \log_2 0.8 - 0.2 \log_2 0.2
  \]
  \[
  H(X) \approx 0.72193 \, \text{bit/symbol}
  \]
- **最小文件尺寸**：
  \[
  \text{最小文件尺寸} = H(X) \cdot N \approx 0.72193 \cdot 102400 = 73,925 \, \text{byte}
  \]
- **压缩比**：
  \[
  \text{压缩比} = \frac{1}{H(X)} = \frac{1}{0.72193} \approx 1.3852
  \]


## 4. 实验与理论对比
实验需要通过 7z 工具对上述消息文件进行压缩，将其压缩结果与理论极限进行对比:

#### 1. 等概率分布
Huffman Coder:
- **压缩比**：
  \[
  \text{压缩比} = \frac{输入大小}{输出大小} = 102400/103175 \approx 0.9925
  \]

7-Zip:
- **压缩比**：
  \[
  \text{压缩比} = \frac{输入大小}{输出大小} = 102400/102548 \approx 0.9986
  \]


#### 2. 偏概率分布 1 (\( P(x_0) = 0.8, P(x_1) = 0.2 \))
Huffman Coder:
- **压缩比**：
  \[
  \text{压缩比} = \frac{输入大小}{输出大小} = 102400/75926 \approx 1.3487
  \]

7-Zip:
- **压缩比**：
  \[
  \text{压缩比} = \frac{输入大小}{输出大小} = 102400/77482 \approx 1.3216
  \]

#### 3. 偏概率分布 2 (\( P(x_0) = 0.3, P(x_1) = 0.7 \))
Huffman Coder:
- **压缩比**：
  \[
  \text{压缩比} = \frac{输入大小}{输出大小} = 102400/91636 \approx 1.1175
  \]

7-Zip:
- **压缩比**：
  \[
  \text{压缩比} = \frac{输入大小}{输出大小} = 102400/92410 \approx 1.1081
  \]

可见：
* 当源文件不是等概率分布时，压缩效果往往可以比7-Zip好。
* 无论是霍夫曼编码还是7-Zip压缩工具，在等概率分布的信源输入情况下，都不能实现数据压缩，甚至变得更长。

可能的差距原因包括：
在信息理论中，**信源编码定理**指出，对于一个离散无记忆信源，其符号的最小平均编码长度由信源的**熵**决定。熵是衡量信源不确定性的指标，定义为：
\[
H(X) = -\sum_{i} p(x_i) \log_2 p(x_i)
\]
其中，\( p(x_i) \) 是符号 \( x_i \) 出现的概率。

在实际应用中，压缩算法试图接近这一理论极限，但由于多种因素，实际压缩结果通常高于理论最小值。以下是导致这一差异的主要原因及其详细分析：
### 4.1 文件头信息
压缩文件通常包含元数据，例如：
- 文件名；
- 时间戳；
- 压缩方法；
- 文件校验信息（如 CRC 校验码）。

这些元数据为文件管理和传输提供必要的信息，但会占用额外空间，从而导致压缩文件大小增加。
### 4.2 对齐填充
为了满足特定存储或传输设备的要求，压缩算法可能会在数据块之间添加填充字节以确保对齐。例如：
- 数据块的起始地址可能需要对齐到某个固定的字节边界（如 4 字节、8 字节）。
- 这些填充字节并不携带任何有效信息，但会显著增加压缩文件的大小，尤其是对于小文件。
### 4.3 压缩算法的实现差异
不同压缩算法在处理相同数据时，可能产生不同的压缩比。以下是可能导致差异的因素：
- **优化程度**：算法是否经过高度优化（如算术编码的实现效率）。
- **参数设置**：例如块大小、字典大小等参数直接影响压缩效果。
- **数据预处理**：是否对数据进行预处理（如重复模式提取、哈希映射）。
  
即使是同一算法的不同实现，因设计目标和硬件优化程度不同，压缩效果也会有所差异。
### 4.4 概率分布不匹配
理论计算基于信源概率分布的准确假设，压缩算法才能最优地利用数据的冗余性。然而，在实际中：
- 数据的概率分布可能复杂且多变，与理想假设不一致；
- 压缩算法可能基于局部概率分布估计，而非全局概率分布。

如果实际数据的概率分布与假设不符，算法无法充分利用数据中的冗余性，导致压缩效果不佳。
### 4.5 无失真假设与实际误差
理论计算通常假设无失真压缩，即解压后数据完全还原。但是：实际压缩可能引入**量化误差**或**舍入误差**；并且某些压缩算法（如有损压缩）可能舍弃部分信息以提高压缩比。虽然这些误差通常较小，但它们会使实际压缩结果偏离理论极限。