# 理论推导

## 1.1重复码基本原理

重复码（Repetition Code）是通过对原始信息序列进行重复而实现接收端检错能力的一种简单的纠错编码方式，广泛用于提高数据在信道中的可靠传输。其基本原理如下：

### 1.1.1 编码过程
重复码的核心思想是通过将每个信息比特重复多次来增加冗余，以抵抗信道中的错误。在编码过程中：
- 每个比特 \( b \) 被重复 \( n \) 次后进行传输。例如，原始比特 \( 1 \) 变为 \( 111 \cdots 1 \)，原始比特 \( 0 \) 变为 \( 000 \cdots 0 \)。
- 若要传输一个比特 \( b \)，通过重复编码，将其变为长度为 \( n \) 的符号序列。例如：
  - \( b = 1 \) 变为 \( 111 \)（当 \( n = 3 \) 时）；
  - \( b = 0 \) 变为 \( 000 \)（当 \( n = 3 \) 时）。

### 1.1.2 解码过程
接收端收到通过重复码编码的比特序列后，使用多数投票规则来恢复原始比特：
- 如果接收到的 \( n \) 个比特中，1 的数量大于 0 的数量，则解码为 1；
- 如果接收到的 \( n \) 个比特中，0 的数量大于 1 的数量，则解码为 0；
- 如果 \( n \) 为偶数，且 1 和 0 的数量相等，则无法确定解码结果，通常会产生错误。

举一个简单的例子，接收到的比特序列 \( 111 \) 将被解码为 1，而 \( 110 \) 或 \( 101 \) 也将被解码为 1，表示比特值 1 的可能性较大。

### 1.1.3 重复码的纠错能力
重复码的纠错能力取决于重复码的长度 \( n \)，并且纠错能力与重复码的奇偶性有关：
- **若 \( n \) 为奇数**，重复码可以纠正最多 \( \frac{n-1}{2} \) 个错误。例如，当 \( n = 3 \) 时，最多可以纠正 1 个错误；当 \( n = 5 \) 时，最多可以纠正 2 个错误。
- **若 \( n \) 为偶数**，重复码的纠错能力较弱，因为在偶数情况下，无法保证能够区分多于一半的错误。这也是为什么要使用奇数值的 \( n \) 来提高纠错能力的原因。
**因此，在实验要求中明确指出重复码的码字长度，必须是大于2小于10的奇数（2<n<10且n为奇数）。**
---

### 总结
重复码通过将比特重复传输并使用多数投票规则解码，从而增加冗余并提高抗错误能力。重复码的纠错能力取决于重复码长度 \( n \)，其纠错能力随着 \( n \) 的增加而提高。适当选择 \( n \) 的值，能有效平衡错误纠正能力和数据冗余，确保在信道中以较高的可靠性传输数据。

---

## 1.2 BSC 信道特性

**二元对称信道（BSC）** 是信息理论中的一种理想化信道模型，在之前的实验已经详细的了解过DSC的特性，因此在本次实验中简单总结其主要特性：

- **错误传递概率**：输入比特 \( X \) 在信道传输过程中，以概率 \( p \) 翻转，即：
  \[
  P(Y \neq X) = p, \quad P(Y = X) = 1 - p
  \]
  其中，\( p \) 为信道的错误传递概率。翻转的概率 \( p \) 描述了信道的噪声强度。

### 信道输出符号分布
在重复码长度为 \( n \) 的情况下，通过 BSC 信道传输时：
- 每个比特的翻转概率为 \( p \)；
- 接收到 \( k \) 个翻转比特的概率为：
  \[
  P(k \text{ flips}) = \binom{n}{k} p^k (1-p)^{n-k}
  \]
  其中，\( \binom{n}{k} \) 是二项式系数，表示从 \( n \) 个比特中选出 \( k \) 个错误比特的组合数。

这个公式表示了接收端在信道传输过程中收到特定错误数量的概率。

---

## 1.3 理论误码率推导

设传输码长为 \( n \)，传输错误概率为 \( p \)。多数投票解码的误码率 \( P_e \) 为：
\[
P_e = \sum_{k=\lceil \frac{n+1}{2} \rceil}^n \binom{n}{k} p^k (1-p)^{n-k}
\]
其中：
- \( \lceil \frac{n+1}{2} \rceil \) 表示纠错能力的临界值，表示需要翻转超过半数的比特时，才会发生解码错误。
- 该公式计算了接收端错误解码的概率，也就是信道误码率。

具体来说：
- 如果接收到的比特中错误的数量 \( k \) 超过了大约 \( n/2 \)（即多数投票失败），则解码会出错。
- 因此，误码率就是当错误数量 \( k \) 大于或等于临界值 \( \lceil \frac{n+1}{2} \rceil \) 时，信号被错误解码的概率。

这个推导公式表明，随着 \( n \) 的增加，重复码的纠错能力也会增强，误码率 \( P_e \) 会下降，但误码率也与信道的错误传递概率 \( p \) 密切相关。当 \( p \) 较大时，重复码的纠错能力会逐渐下降。

---
## 2. 计算重复码长 \( n = 3, 5, 7 \) 的误码率

### 2.1 \( n = 3 \) 的误码率
对于 \( n = 3 \)，多数投票的临界值为 \( \lceil \frac{3+1}{2} \rceil = 2 \)。  
解码错误的条件是：错误比特数 \( k \geq 2 \)。  
误码率为：
\[
P_e = \binom{3}{2} p^2 (1-p) + \binom{3}{3} p^3
\]
得：
\[
P_e = 3p^2 (1-p) + p^3
\]

### 2.2 \( n = 5 \) 的误码率
对于 \( n = 5 \)，多数投票的临界值为 \( \lceil \frac{5+1}{2} \rceil = 3 \)。  
解码错误的条件是：错误比特数 \( k \geq 3 \)。  
误码率为：
\[
P_e = \binom{5}{3} p^3 (1-p)^2 + \binom{5}{4} p^4 (1-p) + \binom{5}{5} p^5
\]
即：
\[
P_e = 10p^3 (1-p)^2 + 5p^4 (1-p) + p^5
\]

### 2.3 \( n = 7 \) 的误码率
对于 \( n = 7 \)，多数投票的临界值为 \( \lceil \frac{7+1}{2} \rceil = 4 \)。  
解码错误的条件是：错误比特数 \( k \geq 4 \)。  
误码率为：
\[
P_e = \binom{7}{4} p^4 (1-p)^3 + \binom{7}{5} p^5 (1-p)^2 + \binom{7}{6} p^6 (1-p) + \binom{7}{7} p^7
\]
即：
\[
P_e = 35p^4 (1-p)^3 + 21p^5 (1-p)^2 + 7p^6 (1-p) + p^7
\]

---

## 3. 具体错误概率的代入计算

### 3.1 错误概率 \( p = 0.2 \)
- \( n = 3 \)：  
  \[
  P_e = 3(0.2)^2 (1-0.2) + (0.2)^3 = 3 \cdot 0.04 \cdot 0.8 + 0.008 = 0.104
  \]
- \( n = 5 \)：  
  \[
  P_e = 10(0.2)^3 (1-0.2)^2 + 5(0.2)^4 (1-0.2) + (0.2)^5 = 0.032 + 0.004 + 0.00032 = 0.03632
  \]
- \( n = 7 \)：  
  \[
  P_e = 35(0.2)^4 (1-0.2)^3 + 21(0.2)^5 (1-0.2)^2 + 7(0.2)^6 (1-0.2) + (0.2)^7
  \]
  按步骤计算可得 \( P_e \approx 0.009824 \)。

### 3.2 错误概率 \( p = 0.5 \)
当 \( p = 0.5 \) 时，符号传输是随机的，解码过程无法利用任何冗余信息，因此误码率趋近于 \( 0.5 \)，即：
  \[
  P_e = 0.5
  \]

### 3.3 错误概率 \( p = 0.7 \)  
按同样公式代入计算得各 \( P_e \)，数值分别约为：
- \( n = 3 \)：\( P_e \approx 0.784 \)；
- \( n = 5 \)：\( P_e \approx 0.942 \)；
- \( n = 7 \)：\( P_e \approx 0.987 \)。
当 \( p = 0.7 \) 时，重复码的效果较差，解码错误的概率增加。
---

## 4. 观察、总结
**1**. 随着重复码长度 \( n \) 的增加，误码率 \( P_e \) 显著下降

重复码的主要优势在于其能够通过增加冗余来提高信号的可靠性。当信道中的噪声引起错误时，冗余比特帮助接收端通过多数投票规则正确恢复原始比特。误码率 \( P_e \) 是指在解码过程中，由于错误传输导致的错误解码的概率。

对于重复码，当码长 \( n \) 增加时，接收到的比特中出现错误的次数需要达到一定数量才能导致解码错误。随着 \( n \) 增加，接收到的比特中需要出现更多的错误才会导致误解码，因此误码率 \( P_e \) 会显著下降。

数学上，误码率 \( P_e \) 可以通过以下公式计算：
\[
P_e = \sum_{k=\lceil \frac{n+1}{2} \rceil}^n \binom{n}{k} p^k (1-p)^{n-k}
\]
其中：
- \( n \) 是重复码的长度；
- \( p \) 是信道的错误传递概率；
- \( k \) 是发生错误的比特数量，解码错误发生在 \( k \geq \lceil \frac{n+1}{2} \rceil \) 时。

随着 \( n \) 增加，\( k \) 的阈值也增加，导致误解码的概率变小，因此误码率 \( P_e \) 随着 \( n \) 的增加而显著下降。


**2**. 当信道错误概率 \( p \) 较大（\( p = 0.7 \)），重复码的纠错能力显著降低

重复码的效果与信道的错误概率 \( p \) 密切相关。信道错误概率 \( p \) 表示在信号传输过程中每个比特被翻转的概率。当 \( p \) 较大时，即信道噪声较强，重复码的纠错能力会显著降低。

- **小 \( p \) 值**：当 \( p \) 较小（例如 \( p = 0.2 \)），重复码可以有效地利用多数投票来纠正传输错误，从而显著降低误码率 \( P_e \)。
- **大 \( p \) 值**：当 \( p \) 较大（例如 \( p = 0.7 \)），每个比特被翻转的概率增加，使得解码时即使是重复码的多数投票规则也难以正确恢复原始比特。此时，重复码的纠错能力变差，误码率会显著上升。

对于 \( p = 0.7 \)，重复码的冗余数据虽然能提高纠错能力，但信道本身的高噪声使得多数投票规则无法有效纠正错误。因此，随着 \( p \) 增加，重复码的纠错能力逐渐失效。

**3**. 当 \( p = 0.5 \) 时，重复码不会带来改进，因为此时的信号完全随机

当信道错误概率 \( p = 0.5 \) 时，信道中的比特传输实际上是完全随机的：
- 如果 \( p = 0.5 \)，每个比特有 50% 的概率翻转和 50% 的概率保持不变。换句话说，接收端对接收到的比特无法做出任何有效的判断，因为接收的信号对原始比特的依赖性完全丧失。
- 在这种情况下，无论使用多长的重复码，重复的比特序列与原始信息之间的相关性都会丧失。即使使用 \( n = 3 \) 或更大的重复码，解码结果仍然是随机的。

这种情况下，重复码的冗余并没有起到实际作用，因为信号的传输完全是随机的，不能有效地利用多数投票规则进行纠错,重复码并不会改善误码率。

## 5. 误差分析

### **5.1 有限样本效应**
- **理论误码率的基础**：理论误码率通常基于无限大数据量的统计推导，在这种情况下，误码率的计算能够充分体现信道的统计特性。
- **实验误码率的局限**：实际实验中，文件大小有限，接收的数据样本数较少。这会导致误码率的估计值可能偏离理论值，尤其当文件较小时，误差更为显著。

### **5.2 算法实现误差**
- **浮点运算误差**：在解码过程中，尤其是在计算概率分布或多数投票时，存在舍入误差或浮点运算精度的限制。
- **实现细节问题**：不同的编码或解码算法对同一数据集的处理方式略有不同，
  例如：
  - 多数投票规则是否严格按照中点处理；
  - 数据传输中的边界条件处理是否一致。

### **5.3 信道特性不理想**
- **理想信道假设**：理论推导通常假设信道为完全独立的二元对称信道（BSC），即每个比特的传输错误是独立的，且遵循相同的错误概率 \( p \)。
- **实际信道特性**：
  - 数据块之间可能存在相关性，例如连续比特出现相似的错误模式；
  - 外界干扰可能导致非对称性，即某些比特更容易被翻转。

### **5.4 随机性因素**
- **信道随机性**：实验中，信道噪声的随机性可能导致某些数据块的错误率异常高或异常低。
- **文件大小的限制**：当实验文件较小时，随机性因素的影响更为显著，因为误码率的计算缺乏足够的样本支撑。

---

## 6. 改进建议

### 6.1 优化投票机制
- **问题**：传统的多数投票机制仅基于接收到的重复比特数，未考虑其他上下文信息，可能导致错误决策。
- **改进方法**：
  - **加权多数投票**：为每个比特分配权重，根据信道历史信息或信噪比（SNR）调整权重:
    \[
    \text{Weighted Decision} = \sum_{i=1}^n w_i \cdot b_i
    \]
    其中 \( w_i \) 是权重，\( b_i \) 是接收到的比特值。权重可以根据比特的历史误码概率动态调整。
  - **信道状态感知**：利用信道历史状态或纠错码反馈来调整当前比特的投票权重。

### 6.2 增强冗余设计
- **问题**：重复码虽然能纠正一定数量的错误，但其效率低下，且在高噪声信道中性能有限。
- **改进方法**：
  - **结合其他纠错码**：在重复码的基础上增加更复杂的纠错码（如 CRC、汉明码等），提升整体纠错能力。
    - CRC 校验码可以检测剩余的未纠正错误；
    - 使用 LDPC 或 Turbo 码替代简单重复码，在相同冗余度下显著提升纠错能力。
  - **分组编码**：将数据划分为较小的组，每组独立进行编码和解码，可以降低大文件中的累积误差。

### 6.3 动态调整码长
- **问题**：固定的重复码长度 \( n \) 在不同信道状态下可能表现不佳。例如，低噪声信道中过长的码长浪费冗余，高噪声信道中码长不足导致误码率过高。
- **改进方法**：
  - **自适应重复码**：根据信道的实时状态动态调整重复码长度。
    - 在低噪声信道中使用较短的 \( n \)；
    - 在高噪声信道中增加 \( n \)，以提高纠错能力。
  - **反馈机制**：在接收端检测当前误码率，并将信息反馈给发送端，以调整码长。
  - **优化的冗余控制**：结合信道容量理论，根据信道噪声 \( p \) 动态调整冗余度，使误码率最小化。
